package restful

import (
	"fmt"
	"testing"
)

func TestUserApi_SetRoutes(t *testing.T) {
	fmt.Printf("goroutine 22 [running]:\nruntime/debug.Stack(0x0, 0xc000484400, 0x1f8)\n\t/usr/local/Cellar/go/1.15.5/libexec/src/runtime/debug/stack.go:24 +0x9f\ngithub.com/bb-orz/goinfras/XGin.ZapRecoveryMiddleware.func1.1(0xc0003c84b0, 0x1)\n\t/Users/fun/Code/GoProjects/goinfras/XGin/middleware_recovery.go:45 +0x376\npanic(0x4d6e120, 0xc000506020)\n\t/usr/local/Cellar/go/1.15.5/libexec/src/runtime/panic.go:969 +0x1b9\nreflect.Value.Field(0x4d2c2c0, 0xc00033a0d0, 0x187, 0x0, 0x4d2c2c0, 0xc00033a0d0, 0x187)\n\t/usr/local/Cellar/go/1.15.5/libexec/src/reflect/value.go:850 +0x125\ngorm.io/gorm/schema.(*Field).setupValuerAndSetter.func2(0x4e76a40, 0xc00033a0d0, 0x199, 0x2, 0x5776120, 0xc00010a200)\n\t/Users/fun/Code/go/pkg/mod/gorm.io/gorm@v1.20.8/schema/field.go:393 +0xd1\ngorm.io/gorm/callbacks.ConvertToAssignments(0xc00010c820, 0x50c6120, 0xc0004b20c0, 0xc0004b20c0)\n\t/Users/fun/Code/go/pkg/mod/gorm.io/gorm@v1.20.8/callbacks/update.go:230 +0x1fd1\ngorm.io/driver/mysql.Update(0xc000098960)\n\t/Users/fun/Code/go/pkg/mod/gorm.io/driver/mysql@v1.0.3/update_with_order_by_limit.go:20 +0x1ba\ngorm.io/gorm.(*processor).Execute(0xc000306240, 0xc000098960)\n\t/Users/fun/Code/go/pkg/mod/gorm.io/gorm@v1.20.8/callbacks.go:105 +0x23d\ngorm.io/gorm.(*DB).Updates(0xc000098960, 0x4d010e0, 0xc00033a0d0, 0xc0003040e0)\n\t/Users/fun/Code/go/pkg/mod/gorm.io/gorm@v1.20.8/finisher_api.go:318 +0xa7\ngoapp/core/user.(*UsersDAO).UpdateUsers(0x57748b8, 0xf, 0xf, 0x0, 0x0, 0xc0000a0152, 0x5, 0x12, 0x1, 0xc000348080, ...)\n\t/Users/fun/Code/GoProjects/goapp-account/core/user/users_dao.go:160 +0x189\ngoapp/core/user.(*UserDomain).UpdateUsers(0xc0005b0cb0, 0xf, 0xf, 0xc0000a0152, 0x5, 0x12, 0xc000348080, 0x3e, 0x1, 0xc0000a61c0, ...)\n\t/Users/fun/Code/GoProjects/goapp-account/core/user/user_domain.go:218 +0x11a\ngoapp/services.(*UserServiceV1).SetUserInfos(0x57748b8, 0xf, 0xc0000a0152, 0x5, 0x12, 0xc000348080, 0x3e, 0x1, 0x110, 0x4e04bc0)\n\t/Users/fun/Code/GoProjects/goapp-account/services/user_service_v1.go:204 +0x29b\ngoapp/restful.(*UserApi).setUserInfoHandler(0x57748b8, 0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goapp-account/restful/user_restful.go:260 +0x4c8\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngoapp/restful/middleware.JwtAuthMiddleware.func1(0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goapp-account/restful/middleware/auth_middleware.go:33 +0x5d6\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngoapp/restful/middleware.ErrorMiddleware.func1(0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goapp-account/restful/middleware/error_middleware.go:14 +0x45\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngoapp/restful/middleware.ResponseMiddleware.func1(0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goapp-account/restful/middleware/response_middleware.go:13 +0x45\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngithub.com/bb-orz/goinfras/XGin.ZapRecoveryMiddleware.func1(0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goinfras/XGin/middleware_recovery.go:59 +0x5a\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngithub.com/bb-orz/goinfras/XGin.ZapLoggerMiddleware.func1(0xc0003c84b0)\n\t/Users/fun/Code/GoProjects/goinfras/XGin/middleware_logger.go:34 +0x114\ngithub.com/gin-gonic/gin.(*Context).Next(0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/context.go:161 +0x3b\ngithub.com/gin-gonic/gin.(*Engine).handleHTTPRequest(0xc0003323c0, 0xc0003c84b0)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/gin.go:409 +0x67a\ngithub.com/gin-gonic/gin.(*Engine).ServeHTTP(0xc0003323c0, 0x50c5220, 0xc0005840e0, 0xc000128200)\n\t/Users/fun/Code/go/pkg/mod/github.com/gin-gonic/gin@v1.6.3/gin.go:367 +0x14d\nnet/http.serverHandler.ServeHTTP(0xc000584000, 0x50c5220, 0xc0005840e0, 0xc000128200)\n\t/usr/local/Cellar/go/1.15.5/libexec/src/net/http/server.go:2843 +0xa3\nnet/http.(*conn).serve(0xc0004dc1e0, 0x50cd4a0, 0xc000307880)\n\t/usr/local/Cellar/go/1.15.5/libexec/src/net/http/server.go:1925 +0x8ad\ncreated by net/http.(*Server).Serve\n\t/usr/local/Cellar/go/1.15.5/libexec/src/net/http/server.go:2969 +0x36c\n")
}
